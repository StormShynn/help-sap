<!doctype HTML PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html lang="EN">
<!-- ABAPEXEC_CURSOR -->

<!-- Mirrored from help.sap.com/doc/abapdocu_751_index_htm/7.51/en-US/abapexec_cursor.htm by HTTrack Website Copier/3.x [XR&CO'2014], Thu, 20 Jan 2022 17:43:46 GMT -->
<head>
<meta http-equiv="content-type" content="text/html; charset=utf-8">
<meta name="author" content="SAP">
<meta name="description" content="EXEC SQL - OPEN, FETCH, CLOSE">
<title>
EXEC SQL - OPEN, FETCH, CLOSE - ABAP Keyword Documentation
</title>
<link rel="icon" href="ABAPIcon.ico" type="image/ico">
<link rel="shortcut icon" href="ABAPIcon.ico">
<LINK rel="stylesheet" href="abap_docu.css" type="text/css">
<script type="text/JavaScript">
function call_link(linked_file)
{
   if(parent.frames.length>0){
     parent.window.frames["basefrm"].window.location = linked_file;
     parent.window.frames["treeframe"].window.location = "abap_docu_tree92bd.html?file=" + linked_file;}
   else {
     window.location = linked_file;}
}
function urlToClipboard(id){
 try{ var loc = top.location.href;}
 catch(e){ alert( "URL cannnot be determined" ); return; }
 var field = document.getElementById(id);
 field.focus();
 if ( loc.search( ".htm" ) == -1 && loc.search( ".HTM" ) == -1  ){ loc = loc + "index.htm"; }
 if (   loc.search( "index.html" ) != -1
     || loc.search( "INDEX-2.html" ) != -1 ){
   var off = loc.search( "file=" );
   if ( off == -1  ){
     field.value = loc + "?file=abapexec_cursor.htm"; }
   else {
     field.value = loc.substring( 0, off ) + "file=abapexec_cursor.htm";
   }
 }
 else {
    field.value = loc; }
 field.setSelectionRange(0, field.value.length);
 var r = confirm( "Copy URL to clipboard?\n\n" + field.value + "\n\nCopy to clipboard does not work in all browsers." );
 if (r == true) {
   try{
     document.execCommand("copy");
   }
     catch(e){ alert( "URL could not be copied to clipboard" ); }
 }
 window.scrollTo(0,0);
}
</script>
</head>
<body>
<div class="all">
<p class="copyright">SAP NetWeaver AS ABAP Release 751, &copy;Copyright 2017 SAP AG. All rights reserved.
&nbsp;<input type="button" value="URL" style="font-size:8px; width:26px; height:16px; padding:0"
 onclick="urlToClipboard('url')" title="Copy URL to Clipboard" >
</p>
<span class="path">
<a href="javascript:call_link('abenabap.html')" class="blue">ABAP - Keyword Documentation</a>&nbsp;&rarr;&nbsp;
<a href="javascript:call_link('abenabap_reference.html')" class="blue">ABAP - Reference</a>&nbsp;&rarr;&nbsp;
<a href="javascript:call_link('abenabap_language_external_data.html')" class="blue">Processing External Data</a>&nbsp;&rarr;&nbsp;
<a href="javascript:call_link('abenabap_sql.html')" class="blue">ABAP Database Accesses</a>&nbsp;&rarr;&nbsp;
<a href="javascript:call_link('abennative_sql.html')" class="blue">Native SQL</a>&nbsp;&rarr;&nbsp;
<a href="javascript:call_link('abennativesql.html')" class="blue">EXEC SQL - Embedded Native SQL</a>&nbsp;&rarr;&nbsp;
<a href="javascript:call_link('abapexec.html')" class="blue">EXEC SQL</a>&nbsp;&rarr;&nbsp;
</span>
<A NAME="@@OPEN FOR SELECT@@EXEC SQL@@"></A>
<p><span class="h1">
EXEC SQL - OPEN, FETCH, CLOSE <br><br>
</span></p>
<P>
In embedded <a href="javascript:call_link('abennative_sql_glosry.html')" class="grey" title="Glossary Entry">Native SQL</a>, similar statements to those in
<a href="javascript:call_link('abenopen_sql_glosry.html')" class="grey" title="Glossary Entry">Open SQL</a> can be specified to read data using a
<a href="javascript:call_link('abendatabase_cursor_glosry.html')" class="grey" title="Glossary Entry">database cursor</a>. <br><br>
</P>
<p><span class="h2">
<span class="bold">Syntax</span>
</span></p>
<P>
<span class="qtext">EXEC SQL.</span> <br><span class="qtext">&nbsp;&nbsp;OPEN dbcur FOR SELECT ...</span> <br><span class="qtext">ENDEXEC.</span> <br><br>
</P>
<p><span class="h4">
Effect
</span></p>
<P>
Opens a database cursor <span class="qtext">dbcur</span>. For <span class="qtext">dbcur</span>, a
<a href="javascript:call_link('abenflat_glosry.html')" class="grey" title="Glossary Entry">flat</a> character-like <a href="javascript:call_link('abapexec_host.html')" class="blue">host variable</a> can be specified.
</P>
<p><span class="h4">
Note
</span></p>
<P>
The number of database cursor open simultaneously is restricted by platform. Any attempts to open too many database cursors raise an exception of the class CX_SY_NATIVE_SQL_ERROR. <br><br>
</P>
<A NAME="@@FETCH@@EXEC SQL@@"></A>
<p><span class="h2">
<span class="bold">Syntax</span>
</span></p>
<P>
<span class="qtext">EXEC SQL.</span> <br><span class="qtext">&nbsp;&nbsp;FETCH NEXT dbcur INTO ...</span> <br><span class="qtext">ENDEXEC.</span> <br><br>
</P>
<p><span class="h4">
Effect
</span></p>
<P>
Uses an open database cursor <span class="qtext">dbcur</span> to read data to the
<a href="javascript:call_link('abapexec_host.html')" class="blue">host variables</a> specified after <a href="javascript:call_link('abapexec_into.html')" class="blue"><span class="qtext">INTO</span></a>. <br><br>
</P>
<A NAME="@@CLOSE@@EXEC SQL@@"></A>
<p><span class="h2">
<span class="bold">Syntax</span>
</span></p>
<P>
<span class="qtext">EXEC SQL.</span> <br><span class="qtext">&nbsp;&nbsp;CLOSE dbcur</span> <br><span class="qtext">ENDEXEC.</span> <br><br>
</P>
<p><span class="h4">
Effect
</span></p>
<P>
Closes an opened database cursor <span class="qtext">dbcur</span>.
</P>
<P>
If no row can be read using <span class="qtext">FETCH</span>, <span class="qtext">sy-subrc</span> is
set to 4 by <span class="qtext">ENDEXEC</span>. After a <span class="qtext">FETCH</span> statement,
the system field <span class="qtext">sy-dbcnt</span> is set to the number of rows read up to that point
using the cursor in question. If an overflow occurs because the number or rows is greater than 2,147,483,647, <span class="qtext">sy-dbcnt</span> is set to -1.
</P>
<p><span class="h4">
Note
</span></p>
<P>
It depends on the database system whether the database cursor in the database is closed implicitly after
the extraction of the final row of the results set or not. For this reason, it is advisable to use the statement <span class="qtext">CLOSE dbcur</span> explicitly. <br><br>
</P>
<p><span class="h4">
Example
</span></p>
<P>
Reads multiple rows from the database table SPFLI using cursor handling and host variables in static
Native SQL. If rows are found, <span class="qtext">sy-subrc</span> is set to 0 and <span class="qtext">sy-dbcnt</span> is increased by one for each row read.
</P>
<p class="qtextml1">
<span class="qtext">
PARAMETERS p_carrid TYPE spfli-carrid. <br> <br>DATA:&nbsp;&nbsp;connid&nbsp;&nbsp; TYPE spfli-connid, <br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; cityfrom TYPE spfli-cityfrom, <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; cityto&nbsp;&nbsp; TYPE spfli-cityto. <br>
 <br>EXEC SQL. <br>&nbsp;&nbsp;OPEN dbcur FOR <br>&nbsp;&nbsp;&nbsp;&nbsp;SELECT connid, cityfrom, cityto <br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; FROM spfli <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; WHERE mandt&nbsp;&nbsp;= :sy-mandt AND <br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; carrid = :p_carrid <br>
ENDEXEC. <br> <br>DO. <br>&nbsp;&nbsp;EXEC SQL. <br>&nbsp;&nbsp;&nbsp;&nbsp;FETCH NEXT dbcur INTO :connid, :cityfrom, :cityto <br>
&nbsp;&nbsp;ENDEXEC. <br>&nbsp;&nbsp;IF sy-subrc &lt;> 0. <br>&nbsp;&nbsp;&nbsp;&nbsp;EXIT. <br>&nbsp;&nbsp;ELSE. <br>
&nbsp;&nbsp;&nbsp;&nbsp;... <br>&nbsp;&nbsp;ENDIF. <br>ENDDO. <br> <br>EXEC SQL. <br>&nbsp;&nbsp;CLOSE dbcur <br>ENDEXEC. <br><br> <br><br>
</span>
</p>
<br>
<br>
<br>
<br>
</DIV>
<fieldset style="opacity:0">
<input id="url" type="text" />
</fieldset>
</BODY>

<!-- Mirrored from help.sap.com/doc/abapdocu_751_index_htm/7.51/en-US/abapexec_cursor.htm by HTTrack Website Copier/3.x [XR&CO'2014], Thu, 20 Jan 2022 17:43:46 GMT -->
</html>
